<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="order">
	<insert id="input" parameterType="launch.box.makeit.orders.vo.OrdersVO">
		INSERT INTO orders
		(userSrl,phase,startTime,sort,amount) VALUES
		(#{userSrl},#{phase},now(),#{sort},#{amount});
	</insert>
	<select id="pullRecentInputSrl" resultType="Integer">
		select srl from
		orders order by startTime desc limit 1;
	</select>
	<update id="plusInput" parameterType="launch.box.makeit.orders.vo.OrdersVO">
		UPDATE orders SET
		price=#{price}
		WHERE sort=#{sort};
	</update>

	<select id="pullALlSort" resultType="String">
		SELECT sort FROM orders WHERE phase between 0 and 5;
	</select>

	<select id="pullOrder" parameterType="String" resultType="launch.box.makeit.orders.vo.OrdersVO">
		SELECT * FROM orders WHERE sort=#{sort};
	</select>
	<select id="pullUserBuyList" parameterType="Integer" resultType="launch.box.makeit.orders.vo.OrdersVO">
		SELECT * FROM orders WHERE userSrl=#{userSrl};
	</select>
	<update id="alterAllPhase0to1">
		UPDATE orders SET
		phase=1
		WHERE phase=0;
	</update>
	<update id="alterPhase" parameterType="Map">
		UPDATE orders SET
		phase=#{phase}
		WHERE srl=#{srl};
	</update>
	<select id="pullPayedSort" resultType="String">
		SELECT sort FROM orders WHERE phase=6;
	</select>
	<select id="pullPhase" parameterType="Integer" resultType="String">
		SELECT sort FROM orders WHERE phase=#{value};
	</select>
	<select id="pullUserSrl" parameterType="Integer" resultType="Integer">
		SELECT userSrl FROM orders WHERE srl=#{value};
	</select>
	<select id="pullOrderInfo" parameterType="Integer" resultType="launch.box.makeit.orders.vo.OrdersVO">
		SELECT * FROM orders WHERE srl=#{srl};
	</select>
</mapper>